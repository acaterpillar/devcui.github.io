<!doctype html><html lang=cn dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Prometheus Alerting | 神奇宝贝大师的旅行日记</title>
<meta name=keywords content="prometheus">
<meta name=description content="Desc Text.">
<meta name=author content="cui">
<link rel=canonical href=https://canonical.url/to/page>
<meta name=google-site-verification content="blog">
<meta name=yandex-verification content="blog">
<meta name=msvalidate.01 content="blog">
<link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<link rel=preload href=/images/favicon.png as=image>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://eiyouhe.com/images/favicon.png>
<link rel=icon type=image/png sizes=16x16 href=https://eiyouhe.com/images/favicon.png>
<link rel=icon type=image/png sizes=32x32 href=https://eiyouhe.com/images/favicon.png>
<link rel=apple-touch-icon href=https://eiyouhe.com/images/favicon.png>
<link rel=mask-icon href=https://eiyouhe.com/images/favicon.png>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.4">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-213464061-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="Prometheus Alerting">
<meta property="og:description" content="Desc Text.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://eiyouhe.com/posts/prometheus/prometheus-alerting/"><meta property="og:image" content="https://eiyouhe.com/images/head.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-12-05T11:30:03+00:00">
<meta property="article:modified_time" content="2021-12-05T11:30:03+00:00"><meta property="og:site_name" content="神奇宝贝大师的旅行日记">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://eiyouhe.com/images/head.png">
<meta name=twitter:title content="Prometheus Alerting">
<meta name=twitter:description content="Desc Text.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://eiyouhe.com/posts/"},{"@type":"ListItem","position":3,"name":"Prometheus Alerting","item":"https://eiyouhe.com/posts/prometheus/prometheus-alerting/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Prometheus Alerting","name":"Prometheus Alerting","description":"Desc Text.","keywords":["prometheus"],"articleBody":"1.Alerting with Prometheus is separated in to two parts 1-1Alerting rules  Alerting rules is a file that formatted by yml,it’s define some exp in to the yaml file. Alerting rules is in Prometheus servers send alerts to an alert manager and alert manager managed those alerts.  the rule document in there: the rules doc\n1-2Alerting Manager   AlertingManager is a command line tool and the command line tool flags has those functions\n configure immutable system parameters configuration file defines inhibition rules configuration notification routing configuration notification receivers router editor    Alerting notifications steps\n Setup and configure the alert manager Configure Prometheus to talk to the alert manager Create alerting rules in Prometheus    1-2-1 Configs  config.file: specify which configuration file to load./alertmanager --config.file=alertmanager.yml  the file written in the YAML format and defined by the scheme described below  : a duration matching the regular expression [0-9]+(ms|[smhdwy]) : a string matching the regular expression [a-zA-Z_][a-zA-Z0-9_]* : a string of unicode characters : a valid path in the current working directory : a boolean that can take the values true or false : a regular string : a regular string that is a secret, such as a password : a string which is template-expanded before usage : a string which is template-expanded before usage that is a secret : an integer value      there is the simple file and some configs\n1-2-2 Cores   Grouping\n Grouping categorizes alerts of similar nature into a single notification.    Inhibition\n Inhibition is a concept of suppressing notifications for certain alerts if certain other alerts are already firing    Silences\n Silences are a straightforward way to simply mute alerts for a given time. A silence is configured based on matchers, just like the routing tree. Silences are configured in the web interface of the Alert manager.    1-2-3 Notification template Reference 1-2-3-1 Data structures data\n   Name Type Notes     Receiver string The notification will be send to   Status string Defined as firing if at least one alert if firing.otherwise resolved   Alerts Alert List of all alert objects in this group   GroupLabels kv The labels these alerts were grouped by   CommonLabels kv The labels common to all of the alerts   CommonAnnotations kv set of common annotations to all of the alerts. Used for longer additional strings of information about the alert   ExternalURL string Backlink to the alert manager that send the notification    alert\n   Name Type Notes     Status string Defines whether or not the alert is resolved or currently firing   Labels kv A set of labels to be attached to the alert   Annotations kv A set of annotations for the alert   StartsAt time.Time The time the alert started firing   EndsAt time.Time Only set if the end time of an alert is know   GeneratorURL string A backlink which identifies the causing entity of this alert    kv\n   Name Args Returns Notes     SortedPairs - Pairs(list of key/value string pairs) Return s a sorted list of key/value pairs   Remove [] string kv Returns a copy of the key/value map without the given keys.   Names - []string Returns the names of the label names in the labelset   Values - []string Returns the list of values in the labelset    functions\n   Name Args Returns     title string strings.Title,capitalises first character of each word   toUpper string -   toLower string -   match pattern,string Regexp.MatchString.Match a string using Regexp   reReplaceAll pattern,replacement,text Regexp.ReplaceAllString Regexp substitution,unanchored   join sep string,s []string strings.join   safeHtml text string html/template.HTML   stringSlice …string Returns the passed strings as a slice of strings    ","wordCount":"565","inLanguage":"cn","datePublished":"2021-12-05T11:30:03Z","dateModified":"2021-12-05T11:30:03Z","author":{"@type":"Person","name":"cui"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://eiyouhe.com/posts/prometheus/prometheus-alerting/"},"publisher":{"@type":"Organization","name":"神奇宝贝大师的旅行日记","logo":{"@type":"ImageObject","url":"https://eiyouhe.com/images/favicon.png"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://eiyouhe.com accesskey=h title="  (Alt + H)">
<img src=/images/favicon.png alt=logo aria-label=logo height=35> </a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://eiyouhe.com/posts title=列表>
<span>列表</span>
</a>
</li>
<li>
<a href=https://eiyouhe.com/categories title=分类>
<span>分类</span>
</a>
</li>
<li>
<a href=https://eiyouhe.com/tags title=标签>
<span>标签</span>
</a>
</li>
<li>
<a href=https://eiyouhe.com/series title=系列>
<span>系列</span>
</a>
</li>
<li>
<a href=https://eiyouhe.com/archives title=归档>
<span>归档</span>
</a>
</li>
<li>
<a href=https://eiyouhe.com/resume title=冠军>
<span>冠军</span>
</a>
</li>
<li>
<a href=https://eiyouhe.com/psyduck title=救助可达鸭>
<span>救助可达鸭</span>
</a>
</li>
<li>
<a href=https://zukan.pokemon.co.jp/ title=已抓住图鉴>
<span>已抓住图鉴</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://eiyouhe.com>Home</a>&nbsp;»&nbsp;<a href=https://eiyouhe.com/posts/>Posts</a></div>
<h1 class=post-title>
Prometheus Alerting
</h1>
<div class=post-description>
Desc Text.
</div>
<div class=post-meta><span title="2021-12-05 11:30:03 +0000 UTC">December 5, 2021</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;cui&nbsp;|&nbsp;<a href=https://github.com/devcui/devcui.github.io/tree/master/content//posts/prometheus/prometheus-alerting.md rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#1alerting-with-prometheus-is-separated-in-to-two-parts aria-label="1.Alerting with Prometheus is separated in to two parts">1.Alerting with Prometheus is separated in to two parts</a><ul>
<li>
<a href=#1-1alerting-rules aria-label="1-1Alerting rules">1-1Alerting rules</a></li>
<li>
<a href=#1-2alerting-manager aria-label="1-2Alerting Manager">1-2Alerting Manager</a><ul>
<li>
<a href=#1-2-1-configs aria-label="1-2-1 Configs">1-2-1 Configs</a></li>
<li>
<a href=#1-2-2-cores aria-label="1-2-2 Cores">1-2-2 Cores</a></li>
<li>
<a href=#1-2-3-notification-template-reference aria-label="1-2-3 Notification template Reference">1-2-3 Notification template Reference</a><ul>
<li>
<a href=#1-2-3-1-data-structures aria-label="1-2-3-1 Data structures">1-2-3-1 Data structures</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h1 id=1alerting-with-prometheus-is-separated-in-to-two-parts>1.Alerting with Prometheus is separated in to two parts<a hidden class=anchor aria-hidden=true href=#1alerting-with-prometheus-is-separated-in-to-two-parts>#</a></h1>
<h2 id=1-1alerting-rules>1-1Alerting rules<a hidden class=anchor aria-hidden=true href=#1-1alerting-rules>#</a></h2>
<ul>
<li>Alerting rules is a file that formatted by yml,it&rsquo;s define some exp in to the yaml file.</li>
<li>Alerting rules is in Prometheus servers send alerts to an alert manager and alert manager managed those alerts.</li>
</ul>
<p>the rule document in there: <a href=https://blog.eiyouhe.com/articles/2021/01/04/1609740000025.html>the rules doc</a></p>
<h2 id=1-2alerting-manager>1-2Alerting Manager<a hidden class=anchor aria-hidden=true href=#1-2alerting-manager>#</a></h2>
<ul>
<li>
<p>AlertingManager is a command line tool and the command line tool flags has those functions</p>
<ul>
<li>configure immutable system parameters</li>
<li>configuration file defines inhibition rules</li>
<li>configuration notification routing</li>
<li>configuration notification receivers</li>
<li><a href=https://www.prometheus.io/webtools/alerting/routing-tree-editor/>router editor</a></li>
</ul>
</li>
<li>
<p>Alerting notifications steps</p>
<ul>
<li>Setup and configure the alert manager</li>
<li>Configure Prometheus to talk to the alert manager</li>
<li>Create alerting rules in Prometheus</li>
</ul>
</li>
</ul>
<h3 id=1-2-1-configs>1-2-1 Configs<a hidden class=anchor aria-hidden=true href=#1-2-1-configs>#</a></h3>
<ul>
<li>config.file: specify which configuration file to load<code>./alertmanager --config.file=alertmanager.yml</code>
<ul>
<li>the file written in the YAML format and defined by the scheme described below
<ul>
<li><code>&lt;duration></code>: a duration matching the regular expression <code>[0-9]+(ms|[smhdwy])</code></li>
<li><code>&lt;labelname></code>: a string matching the regular expression <code>[a-zA-Z_][a-zA-Z0-9_]*</code></li>
<li><code>&lt;labelvalue></code>: a string of unicode characters</li>
<li><code>&lt;filepath></code>: a valid path in the current working directory</li>
<li><code>&lt;boolean></code>: a boolean that can take the values true or false</li>
<li><code>&lt;string></code>: a regular string</li>
<li><code>&lt;secret></code>: a regular string that is a secret, such as a password</li>
<li><code>&lt;tmpl_string></code>: a string which is template-expanded before usage</li>
<li><code>&lt;tmpl_secret></code>: a string which is template-expanded before usage that is a secret</li>
<li><code>&lt;int></code>: an integer value</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>there is the <a href=https://github.com/prometheus/alertmanager/blob/master/doc/examples/simple.yml>simple file</a> and <a href=https://prometheus.io/docs/alerting/latest/configuration/>some configs</a></p>
<h3 id=1-2-2-cores>1-2-2 Cores<a hidden class=anchor aria-hidden=true href=#1-2-2-cores>#</a></h3>
<ul>
<li>
<p>Grouping</p>
<ul>
<li>Grouping categorizes alerts of similar nature into a single notification.</li>
</ul>
</li>
<li>
<p>Inhibition</p>
<ul>
<li>Inhibition is a concept of suppressing notifications for certain alerts if certain other alerts are already firing</li>
</ul>
</li>
<li>
<p>Silences</p>
<ul>
<li>Silences are a straightforward way to simply mute alerts for a given time.</li>
<li>A silence is configured based on matchers, just like the routing tree.</li>
<li>Silences are configured in the web interface of the Alert manager.</li>
</ul>
</li>
</ul>
<h3 id=1-2-3-notification-template-reference>1-2-3 Notification template Reference<a hidden class=anchor aria-hidden=true href=#1-2-3-notification-template-reference>#</a></h3>
<h4 id=1-2-3-1-data-structures>1-2-3-1 Data structures<a hidden class=anchor aria-hidden=true href=#1-2-3-1-data-structures>#</a></h4>
<p>data</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Receiver</td>
<td>string</td>
<td>The notification will be send to</td>
</tr>
<tr>
<td>Status</td>
<td>string</td>
<td>Defined as firing if at least one alert if firing.otherwise resolved</td>
</tr>
<tr>
<td>Alerts</td>
<td>Alert</td>
<td>List of all alert objects in this group</td>
</tr>
<tr>
<td>GroupLabels</td>
<td>kv</td>
<td>The labels these alerts were grouped by</td>
</tr>
<tr>
<td>CommonLabels</td>
<td>kv</td>
<td>The labels common to all of the alerts</td>
</tr>
<tr>
<td>CommonAnnotations</td>
<td>kv</td>
<td>set of common annotations to all of the alerts. Used for longer additional strings of information about the alert</td>
</tr>
<tr>
<td>ExternalURL</td>
<td>string</td>
<td>Backlink to the alert manager that send the notification</td>
</tr>
</tbody>
</table>
<p>alert</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Status</td>
<td>string</td>
<td>Defines whether or not the alert is resolved or currently firing</td>
</tr>
<tr>
<td>Labels</td>
<td>kv</td>
<td>A set of labels to be attached to the alert</td>
</tr>
<tr>
<td>Annotations</td>
<td>kv</td>
<td>A set of annotations for the alert</td>
</tr>
<tr>
<td>StartsAt</td>
<td>time.Time</td>
<td>The time the alert started firing</td>
</tr>
<tr>
<td>EndsAt</td>
<td>time.Time</td>
<td>Only set if the end time of an alert is know</td>
</tr>
<tr>
<td>GeneratorURL</td>
<td>string</td>
<td>A backlink which identifies the causing entity of this alert</td>
</tr>
</tbody>
</table>
<p>kv</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Args</th>
<th>Returns</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>SortedPairs</td>
<td>-</td>
<td>Pairs(list of key/value string pairs)</td>
<td>Return s a sorted list of key/value pairs</td>
</tr>
<tr>
<td>Remove</td>
<td>[] string</td>
<td>kv</td>
<td>Returns a copy of the key/value map without the given keys.</td>
</tr>
<tr>
<td>Names</td>
<td>-</td>
<td>[]string</td>
<td>Returns the names of the label names in the labelset</td>
</tr>
<tr>
<td>Values</td>
<td>-</td>
<td>[]string</td>
<td>Returns the list of values in the labelset</td>
</tr>
</tbody>
</table>
<p>functions</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Args</th>
<th>Returns</th>
</tr>
</thead>
<tbody>
<tr>
<td>title</td>
<td>string</td>
<td>strings.Title,capitalises first character of each word</td>
</tr>
<tr>
<td>toUpper</td>
<td>string</td>
<td>-</td>
</tr>
<tr>
<td>toLower</td>
<td>string</td>
<td>-</td>
</tr>
<tr>
<td>match</td>
<td>pattern,string</td>
<td>Regexp.MatchString.Match a string using Regexp</td>
</tr>
<tr>
<td>reReplaceAll</td>
<td>pattern,replacement,text</td>
<td>Regexp.ReplaceAllString Regexp substitution,unanchored</td>
</tr>
<tr>
<td>join</td>
<td>sep string,s []string</td>
<td>strings.join</td>
</tr>
<tr>
<td>safeHtml</td>
<td>text string</td>
<td>html/template.HTML</td>
</tr>
<tr>
<td>stringSlice</td>
<td>&mldr;string</td>
<td>Returns the passed strings as a slice of strings</td>
</tr>
</tbody>
</table>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://eiyouhe.com/tags/prometheus/>prometheus</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://eiyouhe.com/posts/prometheus/prometheus-exporter/>
<span class=title>« </span>
<br>
<span>Prometheus Exporter</span>
</a>
<a class=next href=https://eiyouhe.com/posts/prometheus/prometheus-rules/>
<span class=title> »</span>
<br>
<span>Prometheus Rules</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://eiyouhe.com>神奇宝贝大师的旅行日记</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>